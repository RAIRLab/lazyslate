(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const h of r.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();const D=new Map(Object.entries({not:"¬",and:"∧",or:"∨",if:"⟶",iff:"⟷",forall:"∀",exists:"∃"})),J=Array.from(D.keys()),X=[{name:"assume",fullname:"Assumption"},{name:"notI",fullname:"Negation Introduction (Reductio ad absurdum)"},{name:"notE",fullname:"Negation Elimination (Law of excluded middle)"},{name:"andI",fullname:"Conjunction Introduction (Adjunction)"},{name:"andE",fullname:"Conjunction Elimination (Simplification)"},{name:"orI",fullname:"Disjunction Introduction (Addition)"},{name:"orE",fullname:"Disjunction Elimination (Case analysis)"},{name:"ifI",fullname:"Conditional Introduction (Deduction theorem)"},{name:"ifE",fullname:"Conditional Elimination (Modus ponens)"},{name:"iffI",fullname:"Biconditional Introduction"},{name:"iffE",fullname:"Biconditional Elimination"},{name:"forallI",fullname:"Universal Introduction"},{name:"forallE",fullname:"Universal Elimination"},{name:"existsI",fullname:"Existential Introduction"},{name:"existsE",fullname:"Existential Elimination"}],Z=new Map(Object.entries({assume:"Assume"}));for(let e=1;e<X.length;e++){let n=X[e].name;Z.set(n,D.get(n.slice(0,-1))+n.slice(-1))}window.logicalOperatorSymbols=D;window.logicalOperatorNames=J;window.inferenceRules=X;window.inferenceRuleSymbols=Z;class L{constructor(n){this.string=n,this.value=null,this.children=[];let i=this.string.replaceAll("("," ( ").replaceAll(")"," ) ").trim().split(/\s+/);if(i.length==1&&i[0].match(/^[0-9a-zA-Z]+$/))this.value=i[0];else if(i.length>=3&&i[0]=="("&&i[i.length-1]==")"){let s=0,r=[],h="";for(let f=2;f<i.length-1;f++)i[f]==")"?(s--,h+=" "+i[f]+" ",s==0&&(r.push(h),h="")):i[f]=="("?(s++,h+=" "+i[f]+" "):s==0?r.push(i[f]):s>=1&&(h+=" "+i[f]+" ");if(s!=0)this.value="ERROR";else{this.value=i[1];for(let f of r)this.children.push(new L(f))}}else this.value="ERROR"}getValue(){return this.value}getChildren(){return this.children}isValid(){let n=!0;n&&(n=this.value!="ERROR");for(let t of this.children)n&&(n=t.isValid());return n}toString(n=0){if(this.value=="ERROR")return"ERROR";if(this.children.length==0)return this.value;if(this.children.length==1&&J.includes(this.value)&&this.value=="not")return D.get(this.value)+this.children[0].toString(n+1);if(this.children.length==2&&J.includes(this.value)){let t=this.children[0].toString(n+1)+" "+D.get(this.value)+" "+this.children[1].toString(n+1);return n!=0?"("+t+")":t}else{let t=this.value+"(";for(let i of this.children)t+=i.toString(n+1)+",";return t.slice(0,-1)+")"}}toExpressionString(){if(this.children.length==0)return this.value;{let n="("+this.value+" ";for(let t of this.children)n+=t.toExpressionString()+" ";return n.slice(0,-1)+")"}}equals(n){if(!(this.value==n.value)||!(this.children.length==n.children.length))return!1;for(let s=0;s<this.children.length;s++)if(!this.children[s].equals(n.children[s]))return!1;return!0}}function re(e){switch(e.justification){case"assume":return oe(e);case"notI":return he(e);case"notE":return xe(e);case"andI":return le(e);case"andE":return ae(e);case"orI":return de(e);case"orE":return me(e);case"ifI":return ue(e);case"ifE":return fe(e);case"iffI":return ce(e);case"iffE":return pe(e);default:return!1}}function oe(e){return e.assumptions=new Set,e.assumptions.add(e.name),!0}function Q(e){return e.value=="and"&&e.children.length==2}function le(e){if(!Q(e.expression)||e.parents.length!=2)return!1;for(const n of e.parents)if(!e.expression.children[0].equals(n.expression)&&!e.expression.children[1].equals(n.expression))return!1;e.assumptions=new Set;for(const n of e.parents)for(const t of n.assumptions)e.assumptions.add(t);return!0}function ae(e){if(e.parents.length!=1)return!1;let n=e.parents[0];if(!Q(n.expression))return!1;let t=!1;for(const i of n.expression.children)i.equals(e.expression)&&(t=!0);if(!t)return!1;e.assumptions=new Set;for(const i of n.assumptions)e.assumptions.add(i);return!0}function P(e){return e.value=="if"&&e.children.length==2}function ue(e){if(!P(e.expression)||e.parents.length!=1)return!1;let n=e.parents[0];if(!e.expression.children[1].equals(n.expression))return!1;let t=!1,i=null;for(const s of n.assumptions)C(s).expression.equals(e.expression.children[0])&&(t=!0,i=s);if(!t)return!1;e.assumptions=new Set;for(const s of n.assumptions)s!=i&&e.assumptions.add(s);return!0}function fe(e){if(e.parents.length!=2||P(e.parents[0].expression)&&!e.expression.equals(e.parents[0].expression.children[1]))return!1;if(P(e.parents[1].expression)&&!e.expression.equals(e.parents[1].expression.children[1]))return!1;let n=P(e.parents[0].expression)&&e.parents[1].expression.equals(e.parents[0].expression.children[0]),t=P(e.parents[1].expression)&&e.parents[0].expression.equals(e.parents[1].expression.children[0]);if(n==!1&&t==!1)return!1;e.assumptions=new Set;for(const i of e.parents)for(const s of i.assumptions)e.assumptions.add(s);return!0}function U(e){return e.value=="iff"&&e.children.length==2}function ce(e){if(!U(e.expression)||e.parents.length!=2)return!1;let n=null,t=null;if(e.parents[0].expression.equals(e.expression.children[0])){if(n=e.parents[0],!e.parents[1].expression.equals(e.expression.children[1]))return!1;t=e.parents[1]}else{if(!e.parents[0].expression.equals(e.expression.children[1])||(t=e.parents[0],!e.parents[1].expression.equals(e.expression.children[0])))return!1;n=e.parents[1]}let i=!1,s=null;for(const f of n.assumptions)C(f).expression.equals(e.expression.children[1])&&(i=!0,s=f);if(!i)return!1;let r=!1,h=null;for(const f of t.assumptions)C(f).expression.equals(e.expression.children[0])&&(r=!0,h=f);if(!r)return!1;e.assumptions=new Set;for(const f of n.assumptions)f!=s&&e.assumptions.add(f);for(const f of t.assumptions)f!=h&&e.assumptions.add(f);return!0}function pe(e){if(e.parents.length!=2)return!1;let n=null;if(U(e.parents[0].expression)&&(e.parents[0].expression.children[0].equals(e.expression)||e.parents[0].expression.children[1].equals(e.expression)))n=0;else if(U(e.parents[1].expression)&&(e.parents[1].expression.children[0].equals(e.expression)||e.parents[1].expression.children[1].equals(e.expression)))n=1;else return!1;if(n==1){if(!(U(e.parents[1].expression)&&(e.parents[0].expression.equals(e.parents[1].expression.children[0])||e.parents[0].expression.equals(e.parents[1].expression.children[1]))))return!1}else if(!(U(e.parents[0].expression)&&(e.parents[1].expression.equals(e.parents[0].expression.children[0])||e.parents[1].expression.equals(e.parents[0].expression.children[1]))))return!1;e.assumptions=new Set;for(const t of e.parents)for(const i of t.assumptions)e.assumptions.add(i);return!0}function $(e){return e.value=="or"&&e.children.length==2}function de(e){if(!$(e.expression)||e.parents.length!=1)return!1;let n=e.expression.children[0].equals(e.parents[0].expression),t=e.expression.children[1].equals(e.parents[0].expression);if(!n&&!t)return!1;e.assumptions=new Set;for(const i of e.parents[0].assumptions)e.assumptions.add(i);return!0}function me(e){if(e.parents.length!=3)return!1;let n=null,t=null,i=null;for(let o=0;o<e.parents.length;o++){let m=e.parents[o];m.expression.equals(e.expression)?t==null?t=o:i=o:$(m.expression)&&(n=o)}if(n===null||t===null||i===null)return!1;let s=e.parents[n],r=null,h=null,f=null,a=null;for(const o of[t,i])for(const m of e.parents[o].assumptions){let u=C(m);if(r===null&&u.expression.equals(s.expression.children[0])){r=o,h=m;break}if(f===null&&u.expression.equals(s.expression.children[1])){f=o,a=m;break}}if(r===null||f===null)return!1;e.assumptions=new Set;for(const o of e.parents[n].assumptions)e.assumptions.add(o);for(const o of e.parents[r].assumptions)o!=h&&e.assumptions.add(o);for(const o of e.parents[f].assumptions)o!=a&&e.assumptions.add(o);return!0}function N(e){return e.value=="not"&&e.children.length==1}function he(e){if(!N(e.expression)||e.parents.length!=2||!(N(e.parents[0].expression)&&e.parents[0].expression.children[0].equals(e.parents[1].expression)||N(e.parents[1].expression)&&e.parents[1].expression.children[0].equals(e.parents[0].expression)))return!1;let t=null,i=null;for(let s=0;s<2;s++){for(const r of e.parents[s].assumptions)if(C(r).expression.equals(e.expression.children[0])){t=r,i=s;break}if(t!==null)break}if(t===null)return!1;e.assumptions=new Set;for(let s=0;s<2;s++)for(const r of e.parents[s].assumptions)(s!=i||r!=t)&&e.assumptions.add(r);return!0}function xe(e){if(e.parents.length!=2||!(N(e.parents[0].expression)&&e.parents[0].expression.children[0].equals(e.parents[1].expression)||N(e.parents[1].expression)&&e.parents[1].expression.children[0].equals(e.parents[0].expression)))return!1;let t=null,i=null;for(let s=0;s<2;s++){for(const r of e.parents[s].assumptions){let h=C(r);if(N(h.expression)&&new L("(not "+e.expression.toExpressionString()+")").equals(h.expression)){t=r,i=s;break}}if(t!==null)break}if(t===null)return!1;e.assumptions=new Set;for(let s=0;s<2;s++)for(const r of e.parents[s].assumptions)(s!=i||r!=t)&&e.assumptions.add(r);return!0}class V{constructor(n,t,i,s){arguments.length==0?this._default_constructor():arguments.length==4?(this.id=b.length==0?0:b[b.length-1].id+1,this.name=n==""?this.id.toString():n,this.justification=t,this.expression=i,this.assumptions=new Set,this.children=[],this.parents=[],this.verified=!1,this.boundingBox=null,this.topAnchor=null,this.botAnchor=null,this.position=s):console.error("Invalid parameters to proof node constructor")}_default_constructor(){this.id=null,this.name=null,this.justification=null,this.expression=null,this.assumptions=new Set,this.children=[],this.parents=[],this.verified=!1,this.boundingBox=null,this.topAnchor=null,this.botAnchor=null,this.position=null}}let b=[],O=[];function M(e,n=[]){e.verified=re(e),n.push(e.id);for(let t of e.children)n.includes(t.id)||M(t,n)}function ee(e,n,t,i){let s=new V(e,n,t,i);b.push(s),M(s)}function ge(e,n){O.push([e,n]),e.children.push(n),n.parents.push(e),M(n)}function ye(e){let n=e.children;for(const t of e.parents)t.children=t.children.filter(i=>e.id!=i.id);for(const t of e.children)t.parents=t.parents.filter(i=>e.id!=i.id);O=O.filter(t=>!(t[0].id==e.id||t[1].id==e.id)),b=b.filter(t=>t.id!=e.id);for(const t of n)M(t)}function we(e,n){e.children=e.children.filter(t=>n.id!=t.id),n.parents=n.parents.filter(t=>e.id!=t.id),O=O.filter(t=>!(t[0].id==e.id&&t[1].id==n.id)),M(n)}function C(e){for(const n of b)if(e==n.name)return n;return null}var G={exports:{}};G.exports;(function(e){var n=function(){var t=String.fromCharCode,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={};function h(a,o){if(!r[a]){r[a]={};for(var m=0;m<a.length;m++)r[a][a.charAt(m)]=m}return r[a][o]}var f={compressToBase64:function(a){if(a==null)return"";var o=f._compress(a,6,function(m){return i.charAt(m)});switch(o.length%4){default:case 0:return o;case 1:return o+"===";case 2:return o+"==";case 3:return o+"="}},decompressFromBase64:function(a){return a==null?"":a==""?null:f._decompress(a.length,32,function(o){return h(i,a.charAt(o))})},compressToUTF16:function(a){return a==null?"":f._compress(a,15,function(o){return t(o+32)})+" "},decompressFromUTF16:function(a){return a==null?"":a==""?null:f._decompress(a.length,16384,function(o){return a.charCodeAt(o)-32})},compressToUint8Array:function(a){for(var o=f.compress(a),m=new Uint8Array(o.length*2),u=0,p=o.length;u<p;u++){var S=o.charCodeAt(u);m[u*2]=S>>>8,m[u*2+1]=S%256}return m},decompressFromUint8Array:function(a){if(a==null)return f.decompress(a);for(var o=new Array(a.length/2),m=0,u=o.length;m<u;m++)o[m]=a[m*2]*256+a[m*2+1];var p=[];return o.forEach(function(S){p.push(t(S))}),f.decompress(p.join(""))},compressToEncodedURIComponent:function(a){return a==null?"":f._compress(a,6,function(o){return s.charAt(o)})},decompressFromEncodedURIComponent:function(a){return a==null?"":a==""?null:(a=a.replace(/ /g,"+"),f._decompress(a.length,32,function(o){return h(s,a.charAt(o))}))},compress:function(a){return f._compress(a,16,function(o){return t(o)})},_compress:function(a,o,m){if(a==null)return"";var u,p,S={},A={},k="",R="",v="",_=2,E=3,g=2,y=[],l=0,d=0,c;for(c=0;c<a.length;c+=1)if(k=a.charAt(c),Object.prototype.hasOwnProperty.call(S,k)||(S[k]=E++,A[k]=!0),R=v+k,Object.prototype.hasOwnProperty.call(S,R))v=R;else{if(Object.prototype.hasOwnProperty.call(A,v)){if(v.charCodeAt(0)<256){for(u=0;u<g;u++)l=l<<1,d==o-1?(d=0,y.push(m(l)),l=0):d++;for(p=v.charCodeAt(0),u=0;u<8;u++)l=l<<1|p&1,d==o-1?(d=0,y.push(m(l)),l=0):d++,p=p>>1}else{for(p=1,u=0;u<g;u++)l=l<<1|p,d==o-1?(d=0,y.push(m(l)),l=0):d++,p=0;for(p=v.charCodeAt(0),u=0;u<16;u++)l=l<<1|p&1,d==o-1?(d=0,y.push(m(l)),l=0):d++,p=p>>1}_--,_==0&&(_=Math.pow(2,g),g++),delete A[v]}else for(p=S[v],u=0;u<g;u++)l=l<<1|p&1,d==o-1?(d=0,y.push(m(l)),l=0):d++,p=p>>1;_--,_==0&&(_=Math.pow(2,g),g++),S[R]=E++,v=String(k)}if(v!==""){if(Object.prototype.hasOwnProperty.call(A,v)){if(v.charCodeAt(0)<256){for(u=0;u<g;u++)l=l<<1,d==o-1?(d=0,y.push(m(l)),l=0):d++;for(p=v.charCodeAt(0),u=0;u<8;u++)l=l<<1|p&1,d==o-1?(d=0,y.push(m(l)),l=0):d++,p=p>>1}else{for(p=1,u=0;u<g;u++)l=l<<1|p,d==o-1?(d=0,y.push(m(l)),l=0):d++,p=0;for(p=v.charCodeAt(0),u=0;u<16;u++)l=l<<1|p&1,d==o-1?(d=0,y.push(m(l)),l=0):d++,p=p>>1}_--,_==0&&(_=Math.pow(2,g),g++),delete A[v]}else for(p=S[v],u=0;u<g;u++)l=l<<1|p&1,d==o-1?(d=0,y.push(m(l)),l=0):d++,p=p>>1;_--,_==0&&(_=Math.pow(2,g),g++)}for(p=2,u=0;u<g;u++)l=l<<1|p&1,d==o-1?(d=0,y.push(m(l)),l=0):d++,p=p>>1;for(;;)if(l=l<<1,d==o-1){y.push(m(l));break}else d++;return y.join("")},decompress:function(a){return a==null?"":a==""?null:f._decompress(a.length,32768,function(o){return a.charCodeAt(o)})},_decompress:function(a,o,m){var u=[],p=4,S=4,A=3,k="",R=[],v,_,E,g,y,l,d,c={val:m(0),position:o,index:1};for(v=0;v<3;v+=1)u[v]=v;for(E=0,y=Math.pow(2,2),l=1;l!=y;)g=c.val&c.position,c.position>>=1,c.position==0&&(c.position=o,c.val=m(c.index++)),E|=(g>0?1:0)*l,l<<=1;switch(E){case 0:for(E=0,y=Math.pow(2,8),l=1;l!=y;)g=c.val&c.position,c.position>>=1,c.position==0&&(c.position=o,c.val=m(c.index++)),E|=(g>0?1:0)*l,l<<=1;d=t(E);break;case 1:for(E=0,y=Math.pow(2,16),l=1;l!=y;)g=c.val&c.position,c.position>>=1,c.position==0&&(c.position=o,c.val=m(c.index++)),E|=(g>0?1:0)*l,l<<=1;d=t(E);break;case 2:return""}for(u[3]=d,_=d,R.push(d);;){if(c.index>a)return"";for(E=0,y=Math.pow(2,A),l=1;l!=y;)g=c.val&c.position,c.position>>=1,c.position==0&&(c.position=o,c.val=m(c.index++)),E|=(g>0?1:0)*l,l<<=1;switch(d=E){case 0:for(E=0,y=Math.pow(2,8),l=1;l!=y;)g=c.val&c.position,c.position>>=1,c.position==0&&(c.position=o,c.val=m(c.index++)),E|=(g>0?1:0)*l,l<<=1;u[S++]=t(E),d=S-1,p--;break;case 1:for(E=0,y=Math.pow(2,16),l=1;l!=y;)g=c.val&c.position,c.position>>=1,c.position==0&&(c.position=o,c.val=m(c.index++)),E|=(g>0?1:0)*l,l<<=1;u[S++]=t(E),d=S-1,p--;break;case 2:return R.join("")}if(p==0&&(p=Math.pow(2,A),A++),u[d])k=u[d];else if(d===S)k=_+_.charAt(0);else return null;R.push(k),u[S++]=_+k.charAt(0),p--,_=k,p==0&&(p=Math.pow(2,A),A++)}}};return f}();e!=null?e.exports=n:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return n})})(G);var ne=G.exports;function te(){let e=[];for(const t of b)e.push({id:t.id,name:t.name,expression:t.expression.toExpressionString(),justification:t.justification,position:t.position});let n=O.map(t=>[t[0].id,t[1].id]);return JSON.stringify({nodes:e,links:n})}function se(e){b.length=0,O.length=0;const n=JSON.parse(e),t=n.nodes;let i=new Map;for(const r of t){let h=new V;h.id=r.id,h.name=r.name,h.justification=r.justification,h.expression=new L(r.expression),h.position=r.position,b.push(h),i[h.id]=h}const s=n.links;for(const r of s)O.push([i[r[0]],i[r[1]]]),i[r[0]].children.push(i[r[1]]),i[r[1]].parents.push(i[r[0]]);for(const r of b)r.parents.length==0&&M(r)}window.addEventListener("load",function(){let e=document.getElementById("justification-input");for(const t of X)e.innerHTML+="<option value="+t.name+">"+t.fullname+"</option>";let n=document.getElementById("create-node-button");n.disabled=!0,document.getElementById("canvas-blocker").style.display="none",document.getElementById("new-node-menu").style.display="none",window.closeNewNodeMenu=W,window.onCreateNodeButtonPress=F,window.onEditNodeButtonPress=Se,window.onCreateNodeButtonPress=F,window.onCreateNodeButtonPress=F,window.formulaInput=ie});function B(e){let n=document.getElementById(e);return n!=null&&n instanceof HTMLInputElement?n:null}function z(e){let n=document.getElementById(e);return n!=null&&n instanceof HTMLTextAreaElement?n:null}function K(e){let n=document.getElementById(e);return n!=null&&n instanceof HTMLSelectElement?n:null}function ve(e){document.getElementById("canvas-blocker").style.display="inline",document.getElementById("new-node-menu").style.display="inline",document.getElementById("create-node-button").style.display="inline",document.getElementById("edit-node-button").style.display="none",document.getElementById("id-input").style.display="none",B("name-input").value="",B("X-input").value=e.x.toString(),B("Y-input").value=e.y.toString()}function Ee(e){document.getElementById("canvas-blocker").style.display="inline",document.getElementById("new-node-menu").style.display="inline",document.getElementById("create-node-button").style.display="none",document.getElementById("edit-node-button").style.display="inline",document.getElementById("id-input").style.display="inline",B("id-input").value=e.id.toString(),B("name-input").value=e.name,B("X-input").value=e.position.x.toString(),B("Y-input").value=e.position.y.toString(),K("justification-input").value=e.justification,z("formula-input").value=e.expression.toExpressionString(),ie()}function W(){document.getElementById("new-node-menu").style.display="none",document.getElementById("canvas-blocker").style.display="none"}function F(){let e=B("name-input").value,n=K("justification-input").value,t={x:parseInt(B("X-input").value),y:parseInt(B("Y-input").value)},i=new L(z("formula-input").value);ee(e,n,i,t),W(),q()}function Se(){let e=b.filter(n=>B("id-input").value==n.id.toString())[0];e.name=B("name-input").value,e.position.x=parseInt(B("X-input").value),e.position.y=parseInt(B("Y-input").value),e.justification=K("justification-input").value,e.expression=new L(z("formula-input").value),e.assumptions=new Set,W(),M(e),q()}function ie(){let e=z("formula-input").value,n=document.getElementById("formula-output"),t=document.getElementById("create-node-button");if(e=="")n.innerHTML="Formula Output",n.style.backgroundColor="gainsboro",t.disabled=!0;else{let i=new L(e),s=i.isValid();n.innerHTML=i.toString(),n.style.backgroundColor=s?"PaleGreen":"Salmon",t.disabled=!s}}let x=null,I=null,Y=!1,w=null,j=0,T=0;window.addEventListener("load",function(){I=document.getElementById("proof-canvas"),I.width=window.innerWidth,I.height=window.innerHeight,x=I.getContext("2d"),I.addEventListener("dblclick",ke),I.addEventListener("mousemove",Be),I.addEventListener("mousedown",_e),I.addEventListener("mouseup",Ie),window.addEventListener("keydown",be),window.addEventListener("resize",Ae)});CanvasRenderingContext2D.prototype.roundRect==null&&(CanvasRenderingContext2D.prototype.roundRect=function(e,n,t,i,s){return t<2*s&&(s=t/2),i<2*s&&(s=i/2),this.moveTo(e+s,n),this.arcTo(e+t,n,e+t,n+i,s),this.arcTo(e+t,n+i,e,n+i,s),this.arcTo(e,n+i,e,n,s),this.arcTo(e,n,e+t,n,s),this});function H(e){for(const n of b){const t=n.boundingBox;if(t.x0<e.x&&e.x<t.x1&&t.y0<e.y&&e.y<t.y1)return n}return null}function _e(e){Y=!0;let n=e.offsetX+j,t=e.offsetY+T,i={x:n,y:t};if(e.ctrlKey&&w!=null){let s=w,r=H(i);s.id!=r.id&&(s.children.filter(h=>h.id==r.id).length>0?we(s,r):ge(s,r))}else w=H(i);q()}function Ie(e){Y=!1;let n=e.offsetX+j,t=e.offsetY+T;w=H({x:n,y:t}),q()}function Be(e){e.buttons==0&&(Y=!1),Y&&(w?(w.position.x+=e.movementX,w.position.y+=e.movementY):(j-=e.movementX,T-=e.movementY),q())}function be(e){if(document.getElementById("new-node-menu").style.display=="none"){if(w!=null&&(e.key==="Backspace"||e.key==="Delete"))ye(w),w=null,q();else if(w!=null&&e.key==="d"){let n=w.name==w.id.toString()?"":w.name,t={x:w.position.x+100,y:w.position.y+100},i=new L(w.expression.toExpressionString());ee(n,w.justification,i,t),w=null,q()}}}function ke(e){let n=e.offsetX+j,t=e.offsetY+T,i={x:n,y:t},s=H(i);s==null?ve(i):Ee(s)}function Ae(e){I=document.getElementById("proof-canvas"),I.width=window.innerWidth,I.height=window.innerHeight,x=I.getContext("2d"),q()}function je(e){Te(e)}function Te(e){x.font="20px Arial";const t=x.measureText(e.name);let i=t.fontBoundingBoxAscent;i==null&&(i=t.actualBoundingBoxAscent+t.actualBoundingBoxDescent+4);const s=e.position.x-j,r=e.position.y-T,h="{"+Array.from(e.assumptions).toString()+"}",f=2*10+Math.max(x.measureText(e.expression.toString()).width,x.measureText(e.name).width,x.measureText(h).width);x.strokeStyle=w!=null&&w.id==e.id?"Indigo":"Black",x.fillStyle=w!=null&&w.id==e.id?"Lavender":"white",x.beginPath(),x.roundRect(s,r,f,3*i+2*10,10),e.boundingBox={x0:s+j,y0:r+T,x1:s+f+j,y1:r+3*i+2*10+T},x.fill(),x.stroke(),x.beginPath(),x.moveTo(s+f/2,r-i),x.lineTo(s+f/2,r),x.stroke(),x.beginPath();const a=Z.get(e.justification),o=x.measureText(a).width+2*10;x.strokeStyle=e.verified?"green":"red",x.roundRect(s+(f-o)/2,r-(2*i+2*10),o,i+2*10,10),x.fill(),x.stroke(),e.topAnchor={x:s+f/2+j,y:r-(2*i+2*10)+T},e.botAnchor={x:s+f/2+j,y:r+3*i+2*10+T},x.fillStyle=w!=null&&w.id==e.id?"Indigo":"Black",x.fillText(e.name,s+10,r+i+10),x.fillText(e.expression.toString(),s+10,r+2*i+10),x.fillText(h,s+10,r+3*i+10),x.fillText(a,s+(f-o)/2+10,r-(i+10))}function qe(e,n){x.strokeStyle="black",x.beginPath(),x.moveTo(e.botAnchor.x-j,e.botAnchor.y-T),x.lineTo(n.topAnchor.x-j,n.topAnchor.y-T),x.stroke()}function Oe(e,n){qe(e,n)}function q(){x.clearRect(0,0,I.width,I.height);for(const e of b)je(e);for(const e of O)Oe(e[0],e[1])}function Re(e,n){let t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(n)),t.setAttribute("download",e),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}function Le(){const e=te(),n=new Date().getTime()+".json";Re(n,e)}function Me(){const e=te(),t=ne.compressToEncodedURIComponent(e).replaceAll("-","%2D"),s=window.location.href.split("?")[0]+"?proof="+t;navigator.clipboard.writeText(s)}function Ne(){let e=document.getElementById("proof-file-input").files[0],n=new FileReader;n.addEventListener("load",()=>{se(n.result.toString()),q()},!1),n.readAsText(e)}window.onDownloadButtonPress=Le;window.onGetLinkButtonPress=Me;window.onProofFileUpload=Ne;window.addEventListener("load",function(){const e=window.location.search,n=new URLSearchParams(e);if(n.has("proof")){const i=n.get("proof").replaceAll("%2D","-"),s=ne.decompressFromEncodedURIComponent(i);se(s),q()}});
